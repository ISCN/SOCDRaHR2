---
title: "ISCN 3.3 data"
author: "K Todd-Brown (ktoddbrown@ufl.edu)"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Purpose: *This vignette describes the ISCN3 data contributions.*


# Setup

```{r setup, echo=FALSE}
library(SOCDRaH2)
library(tidyverse)
library(knitr)
library(kableExtra)
dataDir <- '~/Datasets/ISCN'

knitr::opts_chunk$set(eval=FALSE)
```

```{r fakeSetUp, eval=FALSE}
library(SOCDRaH2)
library(ggplot2)
dataDir <- 'Your/Data/Dir'
```


```{r load, eval=FALSE}
ISCN3.ls <- ISCN3_3(data_dir = dataDir)
```

Some comment on the organization of ISCN3.
Includes a description of the tables, identifying columns and descriptions of the headers.
Also need a citation with the EDI link

Creating a table to show summary statistics of the number of unique sites each dataset in the profile table has.

```{r sites}
profile_summary <- ISCN3.ls$profile %>%
  select(dataset_name_sub, site_name) %>%
  unique()%>%
  group_by(dataset_name_sub) %>% 
  tally(name = 'profile_site_count')

layer_summary <- ISCN3.ls$layer %>%
  select(dataset_name_sub, site_name) %>%
  unique()%>%
  group_by(dataset_name_sub) %>% 
  tally(name = 'layer_site_count')

knitr::kable(full_join(profile_summary, layer_summary, by = c('dataset_name_sub')) %>%
    arrange(layer_site_count), 
  caption = 'Site counts for each contributing dataset submision (dataname_sub) in the profile and layer data table.')%>%
  kable_styling()
```

# Dataset description table

```{r}
study <- ISCN3.ls$study %>% 
  select(dataset_name, `dataset_type (dataset_type)`, dataset_description) 
knitr::kable(study,
  caption = 'Site counts for each contributing dataset submision (dataname_sub) in the profile data table.')%>%
  kable_styling()
```

# Description of the tables and columns

Create a table with the table name, column name, and long description similar to what is on the EDI page.

# New section for each data contribution

Include both a description of the data sets including counts of layers and sites, histograms and tables of variables, and site map.
List data contributions from largest to smallest.

## Myers Smith

The Myers Smith data set in ISCN3 contains `r nrow(dataset_layer)` layer-level rows and `r nrow(dataset_profile)` profile-level information rows after cleaning for ISCN3.5.
ISCN3 removed repeated information in citations, so these column values were corrected and filled for ISCN3.5.
ISCN3 filled in the soil carbon stocks where bulk density and organic carbon was provided, so these columns were removed for ISCN3.5.
This data set was set in Alaska, so the Alaska Location code from the Template was used instead of the generic.

```{r}
plotISCN3(ISCN3 = ISCN3.ls, 'Myers-Smith')
```

# Citations and bibliography

Create a table with each dataset and citation, repeat the dataset name as needed for each citation.

```{r}
#need to gap fill these or find the gap filled ones
study <- citation_raw %>% 
  select(dataset_name, citation) 
knitr::kable(study,
  caption = 'Citations for each contributing dataset submision (dataname_sub).')%>%
  kable_styling()
```

